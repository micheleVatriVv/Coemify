<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coemify</title>
    
    <link rel="icon" href="/static/img/icon.png" type="image/png">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">

    <link rel="stylesheet" href="/static/css/style.css">
    <script src="/static/js/script.js"></script>

</head>
<body>
    
    <div id="alertContainer"></div>
    
    <div class="header">
        <h1>Coemify</h1>
        <p>App ufficiale dei figli della merda</p>
    </div>

    <!-- Form iniziale upload -->
    <div id="uploadSection" class="card p-4 mb-4 w-50">
        <form id="uploadForm" onsubmit="handleUpload(event)">
            <div id="dropZone" class="drop-zone">
                <h2 class="mt-2">ðŸŽµ</h2>

                <p class="mt-4">Drag, Click, Tap</p>
                <input type="file" id="audioFile" accept="audio/*" required hidden>
            </div>
            <div id="fileInfo" class="mt-2" style="font-style:italic; color:#333;"></div>

            <button type="submit" class="w-100">Carica File</button>
        </form>
    </div>

    <!-- Dashboard vera e propria, inizialmente nascosta -->
    <div id="dashboardContent" class="row" style="display:none;">

        <!-- Colonna sinistra: copertina -->
        <div class="col-lg-3 col-md-3 col-sm-12 my-auto">
            <div class="card bg-transparent border-0">
                <div class="cover-container text-center mb-4">
                    <img id="coverImg" src="/static/img/default.png" alt="Copertina">
                    
                    <button type="button" id="uploadCoverBtn" onclick="openCoverDialog()">Carica copertina</button>
                        <input type="file" id="coverFile" accept="image/*" style="display:none;" onchange="previewCover(event)">

                </div>
            </div>
        </div>

        <!-- Colonna centrale: form metadati -->
        <div class="col-lg-6 col-md-6 col-sm-12">
            <div class="card p-4 mb-2">
                <form id="metadataForm" onsubmit="sendFinal(event)">
                    <input type="hidden" id="tempFile">

                    <div class="mb-3">
                        <label for="title" class="form-label">Titolo</label>
                        <input type="text" id="title" class="form-control" required>
                    </div>

                    <div class="mb-3">
                        <label for="artist" class="form-label">Autore</label>
                        <input list="artists" id="artist" class="form-control" placeholder="Inizia a scrivere...">
                        <datalist id="artists"></datalist>
                    </div>

                    <div class="mb-3">
                        <label for="album" class="form-label">Album</label>
                        <input list="albums" id="album" class="form-control" placeholder="Inizia a scrivere...">
                        <datalist id="albums"></datalist>
                    </div>

                    <div class="mb-3">
                        <label for="release_date" class="form-label">Anno</label>
                        <input type="text" id="release_date" class="form-control">
                    </div>
                    <div class="mb-3">
                        <label for="genre" class="form-label">Genere</label>
                        <input list="genres" id="genre" class="form-control" placeholder="Inizia a scrivere...">
                        <datalist id="genres"></datalist>
                    </div>
                    <div class="mb-3">
                        <label for="duration" class="form-label">Durata</label>
                        <input type="text" id="duration" class="form-control">
                    </div>

                    <div class="btn-group d-flex">
                        <button type="button" class="btn btn-light" onclick="searchMetadata()">Cerca metadati</button>
                        <button type="submit" class="btn save">Salva in Navidrome</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Colonna destra: duplicati Navidrome -->
        <div class="col-lg-3 col-md-3 col-sm-12">
            <div class="card bg-transparent border-0">
                <div class="d-flex justify-content-between align-items-center">
                    <h5 class="text-white pt-3">Possibili duplicati</h5>
                    <button id="refreshDuplicates" class="btn btn-sm btn-outline-light" onclick="checkDuplicates()">â†»</button>
                </div>
                <ul id="duplicatesList" class="list-group mt-3"></ul>
            </div>
        </div>
    </div>

    <!-- Spinner di caricamento -->
    <div id="uploadSpinner" class="spinner-border text-white mt-5" role="status" style="display: none;">
        <span class="visually-hidden">Caricamento...</span>
    </div>

    <!-- Modal Bootstrap -->
    <div class="modal fade" id="metadataModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-scrollable modal-lg">
            <div class="modal-content bg-transparent">
                <div class="modal-body" id="metadataCandidates"></div>
            </div>
        </div>
    </div>






    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
